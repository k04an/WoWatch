# WoWatch
Приложения для отслеживания количества игроков на частных серверах World of Warcraft
## Speak english?
`README.md` file is available in [english](https://github.com/k04an/WoWatch/blob/master/README.md).
## Основная информация
### Зачем?
Некоторые сервера WoW предоставляют данные об онлайне их серверов на своем сайте. Пролема в том, что они дают возможность онлайн только в текущий момент времени. Но возможности посмотреть как менялось количество игроков с течением времени нельзя.
### Как это работает?
Приложения собирает актуальную информацию прямо с сайтов серверов и сохраняет их в базу данных с временной меткой. Затем эти данные могут просмотренные в виде графиков.
### Хотите попробовать?
Приложение доступно по [ссылке](http://wowatch.k04an.site/).
## Техническая информация
### Что под капотом?
Приложение написанно на JavaScript и использует [NodeJs](https://nodejs.org) для его интерпретации, а также следующие моудли, чтобы заставить это все работать: 
- [Express](https://expressjs.com) - фреймворк для создания веб-приложений. Используется для марштрутизации и выполняет роль веб-сервера.
- [Sequelize](https://sequelize.org/) - это [ORM](https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping) для NodeJS. Используется для взаимодействия с базой данных без SQL запросов, а при помощи конструкция языкка: обхектов и методов.
- [EJS](https://ejs.co/) - шаблонизатор для генерации HTML разметки при помощи JavaScript.

Также были использованны другие модули сильно упрощающие жизнь при разработке. Такие как [dateformat](https://www.npmjs.com/package/dateformat) и [dotenv](https://www.npmjs.com/package/dotenv), а также некоторые другие. Полный список используемых модулей можно увидеть в файле `package.json`.

[Bootstrap](https://getbootstrap.com/) - CSS фреймворк использовался разметки, мобильной адаптации и наведения красоты.

## Установка
### Начинаем
Копируем этот репозиторий
```bash
git clone https://github.com/k04an/WoWatch
```

Устанавливаем зависимости
```bash
npm install
```

Создаем файл `.env` в директории приложения для настройки приложения. Список опций для файла `.env` представлен ниже.

Запускаем скрипт `db-sync.js` для развертывания структуры базы данных
```bash
npm db-sync
```

И последнее, запускаем скрипты `web.js`, для поднятия веб-сервера и `collector.js` для запуска сборщика данных. Это можно сделать создав демона или использовать менеджер процессов для NodeJs, например [PM2](https://pm2.keymetrics.io/).
```bash
npm i -g pm2
pm2 start web.js
pm2 start collector.js
```

### Конфигурирование приложения с помощью файла .env
Настройка приложения производится через файл `.env`. Ниже представлена структура файла, со всеми настройками.
```Shell
DB_NAME="" # Имя использзуемой базы данных (Не путать с диалектом SQL)
DB_USER="" # Имя пользователя
DB_PASSWORD="" # Пароль от пользователя
DB_HOST="" # Адрес по которому доступна база данных

WEB_PORT=80 # Порт на котором будет поднят веб-сервер (необязательно)

# Частота сбора данных. Использует маску CRON (необязательно, по умолчанию: каждый час)
COLLECTOR_CRONMASK="*/30 * * * *"

COLLECTOR_API_PORT=3761 # Порт для внутреннего API сборщика. Используется для получения информации о статусе сбора данных
```